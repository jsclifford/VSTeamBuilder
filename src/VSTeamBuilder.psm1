<#          License
    GNU GENERAL PUBLIC LICENSE
     Version 3, 29 June 2007
        See License.txt
#>

function New-TBOrg
{
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
     if($PSCmdlet.ShouldProcess("Processing section 1.")){
        #Process something here.
    }
    <#
        .SYNOPSIS
            New-TBOrg will do something wonderful.
        .DESCRIPTION
            New-TBOrg will do something wonderful.
        .EXAMPLE
            New-TBOrg -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Remove-TBOrg
{
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
     if($PSCmdlet.ShouldProcess("Processing section 1.")){
        #Process something here.
    }
    <#
        .SYNOPSIS
            Remove-TBOrg will do something wonderful.
        .DESCRIPTION
            Remove-TBOrg will do something wonderful.
        .EXAMPLE
            Remove-TBOrg -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function New-TBTeam
{
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
     if($PSCmdlet.ShouldProcess("Processing section 1.")){
        #Process something here.
    }
    <#
        .SYNOPSIS
            New-TBTeam will do something wonderful.
        .DESCRIPTION
            New-TBTeam will do something wonderful.
        .EXAMPLE
            New-TBTeam -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Remove-TBTeam
{
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
     if($PSCmdlet.ShouldProcess("Processing section 1.")){
        #Process something here.
    }
    <#
        .SYNOPSIS
            Remove-TBTeam will do something wonderful.
        .DESCRIPTION
            Remove-TBTeam will do something wonderful.
        .EXAMPLE
            Remove-TBTeam -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function New-TBSecurityGroup
{
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
     if($PSCmdlet.ShouldProcess("Processing section 1.")){
        #Process something here.
    }
    <#
        .SYNOPSIS
            New-TBSecurityGroup will do something wonderful.
        .DESCRIPTION
            New-TBSecurityGroup will do something wonderful.
        .EXAMPLE
            New-TBSecurityGroup -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Get-TBSecurityGroup
{
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
    <#
        .SYNOPSIS
            Get-TBSecurityGroup will do something wonderful.
        .DESCRIPTION
            Get-TBSecurityGroup will do something wonderful.
        .EXAMPLE
            Get-TBSecurityGroup -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Add-TBSecurityGroupMember
{
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
     if($PSCmdlet.ShouldProcess("Processing section 1.")){
        #Process something here.
    }
    <#
        .SYNOPSIS
            Add-TBSecurityGroupMember will do something wonderful.
        .DESCRIPTION
            Add-TBSecurityGroupMember will do something wonderful.
        .EXAMPLE
            Add-TBSecurityGroupMember -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Remove-TBSecurityGroupMember
{
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
     if($PSCmdlet.ShouldProcess("Processing section 1.")){
        #Process something here.
    }
    <#
        .SYNOPSIS
            Remove-TBSecurityGroupMember will do something wonderful.
        .DESCRIPTION
            Remove-TBSecurityGroupMember will do something wonderful.
        .EXAMPLE
            Remove-TBSecurityGroupMember -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Set-TBTeamAreaSetting
{
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
     if($PSCmdlet.ShouldProcess("Processing section 1.")){
        #Process something here.
    }
    <#
        .SYNOPSIS
            Set-TBTeamAreaSetting will do something wonderful.
        .DESCRIPTION
            Set-TBTeamAreaSetting will do something wonderful.
        .EXAMPLE
            Set-TBTeamAreaSetting -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Get-TBTeamAreaSetting
{
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
    <#
        .SYNOPSIS
            Get-TBTeamAreaSetting will do something wonderful.
        .DESCRIPTION
            Get-TBTeamAreaSetting will do something wonderful.
        .EXAMPLE
            Get-TBTeamAreaSetting -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Set-TBTeamIterationSetting
{
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
     if($PSCmdlet.ShouldProcess("Processing section 1.")){
        #Process something here.
    }
    <#
        .SYNOPSIS
            Set-TBTeamIterationSetting will do something wonderful.
        .DESCRIPTION
            Set-TBTeamIterationSetting will do something wonderful.
        .EXAMPLE
            Set-TBTeamIterationSetting -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Get-TBTeamIterationSetting
{
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
    <#
        .SYNOPSIS
            Get-TBTeamIterationSetting will do something wonderful.
        .DESCRIPTION
            Get-TBTeamIterationSetting will do something wonderful.
        .EXAMPLE
            Get-TBTeamIterationSetting -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Add-TBTeamIteration
{
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
     if($PSCmdlet.ShouldProcess("Processing section 1.")){
        #Process something here.
    }
    <#
        .SYNOPSIS
            Add-TBTeamIteration will do something wonderful.
        .DESCRIPTION
            Add-TBTeamIteration will do something wonderful.
        .EXAMPLE
            Add-TBTeamIteration -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Get-TBTeamIteration
{
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
    <#
        .SYNOPSIS
            Get-TBTeamIteration will do something wonderful.
        .DESCRIPTION
            Get-TBTeamIteration will do something wonderful.
        .EXAMPLE
            Get-TBTeamIteration -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Set-TBPermission
{
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
     if($PSCmdlet.ShouldProcess("Processing section 1.")){
        #Process something here.
    }
    <#
        .SYNOPSIS
            Set-TBPermission will do something wonderful.
        .DESCRIPTION
            Set-TBPermission will do something wonderful.
        .EXAMPLE
            Set-TBPermission -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Get-TBTokenCollection
{
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
    <#
        .SYNOPSIS
            Get-TBTokenCollection will do something wonderful.
        .DESCRIPTION
            Get-TBTokenCollection will do something wonderful.
        .EXAMPLE
            Get-TBTokenCollection -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Get-TBNamespaceCollection
{
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
    <#
        .SYNOPSIS
            Get-TBNamespaceCollection will do something wonderful.
        .DESCRIPTION
            Get-TBNamespaceCollection will do something wonderful.
        .EXAMPLE
            Get-TBNamespaceCollection -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Get-TBToken
{
    Param(

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName1,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName2,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName3,

        # Parameter help description
        [Parameter(Mandatory = $true)]
        [string]
        $ParameterName4
    )
    <#
        .SYNOPSIS
            Get-TBToken will do something wonderful.
        .DESCRIPTION
            Get-TBToken will do something wonderful.
        .EXAMPLE
            Get-TBToken -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}
function Use-TBConnection
{
    [OutputType([boolean])]
    [cmdletbinding(SupportsShouldProcess = $true, ConfirmImpact = "Medium")]
    Param(

        # TFS/VSTS Collection Name
        [Parameter(Mandatory = $true)]
        [string]
        $CollectionName,

        # TFS/VSTS Server URL or domain
        [Parameter(Mandatory = $true)]
        [string]
        $ServerURL,

        # PAT Token
        [Parameter(Mandatory = $false)]
        [string]
        $PAT,

        # Disconnect Switch
        [switch]
        $Disconnect
    )

    $ErrorState = $false
    $CollectionUrl = "$ServerUrl/$CollectionName"
    $VSTBConn = $Global:VSTBConn
    if($Disconnect){
        if($VSTBConnection -ne $null){
            try{
                $Global:VSTBConn = $null
            }catch{
                Write-Verbose "There was an error $_"
                $ErrorState = $true
            }
        }
        if($null -ne $env:TEAM_ACCT){
            Remove-VSTeamAccount
        }
        $Global:VSTBNamespaceCollection = $null
        $Global:VSTBTokencollection = $null
    }else{
        if($null -eq $VSTBConn){
            # if($ServerURL -eq $null -or $ServerURL -eq ''){
            #     $ErrorState = $true
            #     throw "No ServerURL parameter available."
            # }
            $props = @{
                "ServerURL" = $ServerURL
                "Collectionname" = $CollectionName
                "TeamExplorerConnection" = $null
                "DefaultProjectName" = $null
                "VSTeamAccount" = $false
            }

            $VSTBConn = New-Object -TypeName psobject -Property $props
        }
        if($null -eq $($VSTBConn.TeamExplorerConnection)){
            try{
                #$TFSCmdletsModuleBase = (Get-Module -ListAvailable TfsCmdlets).ModuleBase

                $tfs = [Microsoft.TeamFoundation.Client.TfsTeamProjectCollectionFactory]::GetTeamProjectcollection($CollectionUrl)
                $VSTBconn.TeamExplorerConnection = $tfs
                Write-Verbose "Successfully conected TFS client DLL to: $CollectionName"
            }catch{
                Write-Verbose "There was an error $_"
                $ErrorState = $true
            }
        }else{
            Write-Verbose "Already Connected to TFOM."
        }

        if($null -eq $env:TEAM_ACCT){
            Add-VSTeamAccount -Account $CollectionUrl -UseWindowsAuthentication
            $VSTBConn.VSTeamAccount = $true
            Write-Verbose "Successfully connected TFS VSTeam to: $CollectionName"
        }else{
            Write-Verbose "Already Connected to VSTeam"
        }
    }

    $Global:VSTBConn = $VSTBConn

    return $ErrorState

    <#
        .SYNOPSIS
            Use-TBConnection will do something wonderful.
        .DESCRIPTION
            Use-TBConnection will do something wonderful.
        .EXAMPLE
            Use-TBConnection -Paramater1 "test" -Paramater2 "test2" -Paramater3 "test3" -Paramater4 "test4"
    #>
}

function Set-TBDefaultProject
{
    Param(

        # TFS/VSTS Project
        [Parameter(Mandatory = $true)]
        [string]
        $ProjectName
    )

    $VSTBVersionTable.DefaultProject = $ProjectName
    <#
        .SYNOPSIS
            Set-TBDefaultProject will add the project name to the $VSTBVersionTable Object.
        .DESCRIPTION
            Set-TBDefaultProject will add the project name to the $VSTBVersionTable Object and have all other
            functions use it.
        .EXAMPLE
            Set-TBDefaultProject -ProjectName "MyProjectName"
    #>
}

# Export only the functions using PowerShell standard verb-noun naming.
Export-ModuleMember -Function *-*

